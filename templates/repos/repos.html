{% extends "base.html" %}
{% block container %}
<div class="code">
    <div class="page-header" style="padding-bottom: 0px; margin-top: 0px;">
	    <ul class="breadcrumb" style="margin-bottom: 0px">
            <li>Private: </li>
            <li><h4><a href="/{{ user_name }}/">{{ user_name }}</a> <span class="divider">/</span></h4></li>
            <li><h4><a href="/{{ user_name }}/{{ repos_name }}/">{{ repos_name }}</a></h4></li>
        </ul>
        {% if current == 'index' %}
        <div class="breadcrumb" style="border-top: 0px; padding: 8px;">
    	    <div class="row">
    			<div class="span9">
    			    <p>zzzzzzzzzz — <a href="#README.md">更多介绍</a></p>
    			</div>
    		</div>
    		<div class="row">
    			<div class="span1">
    				<button href="#" class="btn btn-small"><i class="icon-download"></i> ZIP</button>
    			</div>
    			<div class="pull-left" style="margin-left: 30px">
    				<div data-toggle="buttons-radio" class="btn-group">
                        <button class="btn active">HTTP</button>
                        <button class="btn">SSH</button>
                    </div>				
                </div>				
    			<div class="pull-left">
    				<input id="i_git_url" style="margin-bottom: 0px;" type="text" value="http://gitshell.com/{{ user_name }}/{{ repos_name }}.git" class="span5">
    				<i class="icon-list-alt"></i> 只读
    			</div>
    		</div>
		</div>
        {% endif %}
	</div>

	<div class="row">
	    <div id="repos_nav" class="span12">
	        <ul class="nav nav-tabs">
                <li id="i_refs" class="dropdown">
                    <a href="javascript:void" data-toggle="dropdown" class="dropdown-toggle">分支&标签<b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    </ul>
                </li>
                <li {% if current == 'tree' or current == 'index' %} class="active" {% endif %}><a href="/{{ user_name }}/{{ repos_name }}/tree/">文件列表</a></li>
                <li {% if current == 'commits' %} class="active" {% endif %}><a href="/{{ user_name }}/{{ repos_name }}/commits/">提交信息</a></li>
                <li {% if current == 'issues' %} class="active" {% endif %}><a href="/{{ user_name }}/{{ repos_name }}/issues/">Issues</a></li>
                <li {% if current == 'network' %} class="active" {% endif %}><a href="/{{ user_name }}/{{ repos_name }}/network/">协同</a></li>
                <li {% if current == 'branches' %} class="active" {% endif %}><a href="/{{ user_name }}/{{ repos_name }}/branches/">clone 分支</a></li>
                <li {% if current == 'stats' %} class="active" {% endif %}><a href="/{{ user_name }}/{{ repos_name }}/stats/">统计</a></li>
            </ul>
	<div class="file-list">
	<table class="table table-striped">
			<thead>
			  <tr>
				<th></th>
				<th>名称</th>
				<th>修改时间</th>
				<th>日志</th>
			  </tr>
			</thead>
			<tbody>
			  <tr>
				<td><i class="icon-file"></i></td>
				<td><a href="/base.css" title="base.css">base.css</a></td>
				<td>2012.02.03</td>
				<td>增加基础样式文件</td>
			  </tr>
			  <tr>
				<td><i class="icon-file"></i></td>
				<td><a href="/base.css" title="base.css">javascript.css</a></td>
				<td>2012.04.13</td>
				<td>增加用于javascript插件的CSS样式</a></td>
			  </tr>
			  <tr>
				<td><i class="icon-file"></i></td>
				<td><a href="/base.css" title="base.css">index.html</a></td>
				<td>2012.03.29</td>
				<td>首页,项目介绍及入口</td>
			  </tr>
			  <tr>
				<td><i class="icon-folder-close"></i></td>
				<td><a href="/folder" title="base.css">img</a></td>
				<td>2012.04.13</td>
				<td>新加图片目录,存放网站页面用到的图片</a></td>
			  </tr>			  
			</tbody>
		  </table>
		</div>		  
		</div>
	</div>
</div>
{% endblock %}
{% block js %}
<script src="/static/js/moment.min.js"></script>
<script src="/static/js/moment.zh-cn.js"></script>
<script>
/*global jQuery, window */
$(function(){
    moment.lang('zh-cn');
    $('#i_git_url').click(function(event) {
        $('#i_git_url').select();
    });
    var do_refs = function() {
        $.ajax({
            url: '/ajax/repo/{{user_name}}/{{repos_name}}/refs/',
            type: 'POST',
            data: {csrfmiddlewaretoken: '{{ csrf_token }}'},
            dataType: 'json',
            timeout: 5000,
            error: function(){
                //alert('');
            },
            success: function(json){
                for(x in json.branches) {
                    $('#i_refs .dropdown-menu').append('<li><a href="' + json.branches[x] + '">' + json.branches[x] + '</a></li>')
                } 
                if(json.tags.length > 0) {
                    $('#i_refs .dropdown-menu').append('<li class="divider"></li>')
                }
                for(x in json.tags) {
                    $('#i_refs .dropdown-menu').append('<li><a href="' + json.tags[x] + '">' + json.tags[x] + '</a></li>')
                } 
            },
        })
    }
    $('#i_refs').click(function(event) {
        if($('#i_refs .dropdown-menu li').size() == 0) {
            do_refs();
        }
    });
});
</script>
{% endblock %}
