{% extends "user/home_base.html" %}

{% block container_class_name %} user{% endblock %}
{% block subcontainer %}
    <div id='pull_container'>
        <table class="table table-striped">
					<thead class="fixed">
						<th width="28%">标题</th>
						<th width="47%">合并分支</th>
						<th width="25%">描述
							<div class="btn-group pull-right">
								<button id="id_pull_merge" class="btn btn-mini btn-primary">需要我合并的请求</button>
								<button id="id_pull_request" class="btn btn-mini">我发出的</button>
							</div>
						</th>
					</thead>
        <tbody>
        {% if pullRequests %}
					{% for pullRequest in pullRequests %}
						<tr>
              <td><a href="/{{pullRequest.desc_repo.username}}/{{pullRequest.desc_repo.name}}/pull/{{pullRequest.id}}/" class="id">[{{pullRequest.id}}]{{pullRequest.short_title}}</a><br>from<a class="puller" href="/{{pullRequest.pull_user.username}}/">{{pullRequest.pull_user.username}}</a> <span class="label label-mini {{pullRequest.status_label}}">{{pullRequest.status_view}}</span></td>
							<td class="cl_merge_repo_branch"><a href="/{{pullRequest.source_repo.username}}/">{{pullRequest.source_repo.username}}</a>/<a href="/{{pullRequest.source_repo.username}}/{{pullRequest.source_repo.name}}/">{{pullRequest.source_repo.name}}</a>:<a href="/{{pullRequest.source_repo.username}}/{{pullRequest.source_repo.name}}/tree/{{pullRequest.source_refname}}/" class="repo-name">{{pullRequest.source_refname}}</a><i class="icon-long-arrow-right"></i><a href="/{{pullRequest.desc_repo.username}}/">{{pullRequest.desc_repo.username}}</a>/<a href="/{{pullRequest.desc_repo.username}}/{{pullRequest.desc_repo.name}}/">{{pullRequest.desc_repo.name}}</a>:<a href="/{{pullRequest.desc_repo.username}}/{{pullRequest.desc_repo.name}}/tree/{{pullRequest.desc_refname}}/" class="repo-name">{{pullRequest.desc_refname}}</a></td>
							<td>{{pullRequest.short_desc}}</td>
						</tr>
					{% endfor %}
        {% else %}
        <tr>
					<td colspan="3"><p class="text-info">您还没有发起 Pull Request</p></td>
        </tr>
        {% endif %}
        </tbody>
			</table>
    </div>
    <div>
    </div>
{% endblock %}

{% block js %}
<script src="/static/js/moment.min.js"></script>
<script src="/static/js/moment.zh-cn.js"></script>
<script>
$(function(){
    moment.lang('zh-cn');
    $('#id_pull_merge').click(function(){
        window.location.href = '/home/pull/';
    });
    $('#id_pull_request').click(function(){
        window.location.href = '/home/pull/request/';
    });
});
</script>
{% endblock %}
