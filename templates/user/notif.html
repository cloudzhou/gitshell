{% extends "user/dashboard_base.html" %}

{% block subcontainer %}

    {% if notifMessages %}
    <div class="notifs bubble">

      {% for notifMessage in notifMessages %}
        <div class="notif-item">
          <a href="/{{notifMessage.relative_name}}/" class="from">{{notifMessage.relative_name}}</a>
            {% if notifMessage.relative_obj %}
              {% comment %}
                {% if notifMessage.notif_type == 0 %}
                  <span class="muted">commit: </span>{{notifMessage.relative_obj.subject}}
                  <span class="muted"><a href="/{{notifMessage.relative_obj.get_repo_username}}/">{{notifMessage.relative_obj.get_repo_username}}</a>/<a href="/{{notifMessage.relative_obj.get_repo_username}}/{{notifMessage.relative_obj.repo_name}}/">{{notifMessage.relative_obj.repo_name}}</a>:<a href="/{{notifMessage.relative_obj.get_repo_username}}/{{notifMessage.relative_obj.repo_name}}/commits/{{notifMessage.relative_obj.get_short_refname}}/">{{notifMessage.relative_obj.get_short_refname}}</a></span>
              {% endcomment %}
                {% if notifMessage.notif_type == 1 %}
                <p class=""><span class="subject">issues: {{notifMessage.relative_obj.subject}}</span><a href="/{{notifMessage.relative_obj.username}}/{{notifMessage.relative_obj.reponame}}/issues/{{notifMessage.relative_obj.id}}/">#{{notifMessage.relative_obj.id}}</a>
                {% elif notifMessage.notif_type == 2 %}
                <p class=""><span class="subject">评论了issue: {{notifMessage.relative_obj.content}}</span><a href="/{{notifMessage.relative_obj.username}}/{{notifMessage.relative_obj.reponame}}/issues/{{notifMessage.relative_obj.issues_id}}/">#{{notifMessage.relative_obj.issues_id}}</a>
                {% elif notifMessage.notif_type >= 100 and notifMessage.notif_type <= 105 %}
                <p class=""><span class="subject">{{notifMessage.message}} 新的合并请求: </span><a href="/{{notifMessage.relative_obj.desc_repo.username}}/{{notifMessage.relative_obj.desc_repo.name}}/pull/{{notifMessage.relative_obj.id}}/">#{{notifMessage.relative_obj.id}} {{notifMessage.relative_obj.short_title}}</a>
                {% endif %}
                <span class="unixtime hide">{{notifMessage.relative_obj.modify_time|date:"U"}}</span>
              </p>
            {% endif %}
          </div>

      {% endfor %}

    {% else %}
      <div class="notif-item">
        <p>没有更多消息</p>
      </div>
    {% endif %}

  </div>

{% endblock %}
