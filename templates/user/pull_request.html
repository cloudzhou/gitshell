{% extends "user/dashboard_base.html" %}

{% block subcontainer %}

	<div class="bubble" id="pulls">

    {% comment %}
      <ul class="btn-group">
        <li class="first"><button id="pullMerge" class="btn btn-mini">需要我合并的请求</button></li>
        <li class="last"><button id="pullRequest" class="btn btn-mini btn-disable">我发出的</button></li>
      </ul>
    {% endcomment %}

			{% if pullRequests %}
				{% for pullRequest in pullRequests %}
            <section class="pull-item">
                <h3>
                  <a href="/{{pullRequest.desc_repo.username}}/{{pullRequest.desc_repo.name}}/pull/{{pullRequest.id}}/">#{{pullRequest.id}} {{pullRequest.short_title}}</a>
                  <span class="label label-mini {{pullRequest.status_label}}">{{pullRequest.status_view}}</span>
                </h3>
                <p class="pull-right">来自:<a class="muted" href="/{{pullRequest.merge_user.username}}/">{{pullRequest.merge_user.username}}</a></p>
              <div class="meta">
                <span class="branches"><span class="btn"><a href="/{{pullRequest.source_repo.username}}/">{{pullRequest.source_repo.username}}</a>/<a href="/{{pullRequest.source_repo.username}}/{{pullRequest.source_repo.name}}/">{{pullRequest.source_repo.name}}</a>:<a href="/{{pullRequest.source_repo.username}}/{{pullRequest.source_repo.name}}/tree/{{pullRequest.source_refname}}/">{{pullRequest.source_refname}}</a></span><span class="btn"><a href="/{{pullRequest.desc_repo.username}}/">{{pullRequest.desc_repo.username}}</a>/<a href="/{{pullRequest.desc_repo.username}}/{{pullRequest.desc_repo.name}}/">{{pullRequest.desc_repo.name}}</a>:<a href="/{{pullRequest.desc_repo.username}}/{{pullRequest.desc_repo.name}}/tree/{{pullRequest.desc_refname}}/">{{pullRequest.desc_refname}}</a></span></span>
                <p>{{pullRequest.short_desc}}</p>
              </div>
            </section>
				{% endfor %}
			{% else %}
        <div class="pull-item">
					<p class="alert alert-info">您还没有发起 Pull Request</p>
				</div>
			{% endif %}
	</div>


{% endblock %}

{% block js %}
  <script>
    $(function(){
        moment.lang('zh-cn');
        $('#pullMerge').click(function(){
            window.location.href = '/dashboard/pull/';
        });
        $('#pullRequest').click(function(){
            window.location.href = '/dashboard/pull/request/';
        });
    });
  </script>
{% endblock %}
